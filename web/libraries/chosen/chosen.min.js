(function(){class e{constructor(e){this.options_index=0,this.parsed=[],this.copy_data_attributes=e.copy_data_attributes||!1}add_node(e){"OPTGROUP"===e.nodeName.toUpperCase()?this.add_group(e):this.add_option(e)}add_group(e){const t=this.parsed.length;this.parsed.push({array_index:t,group:!0,label:e.label,title:e.title?e.title:void 0,children:0,disabled:e.disabled,hidden:e.hidden,classes:e.className});Array.from(e.childNodes).forEach((s=>this.add_option(s,t,e.disabled)))}add_option(e,t,s){"OPTION"===e.nodeName.toUpperCase()&&(""!==e.text?(null!=t&&(this.parsed[t].children+=1),this.parsed.push({options_index:this.options_index,value:e.value,text:e.text,html:e.innerHTML.trim(),title:e.title?e.title:void 0,selected:e.selected,disabled:!0===s?s:e.disabled,hidden:e.hidden,group_array_index:t,group_label:null!=t?this.parsed[t].label:null,classes:e.className,style:e.style.cssText,data:this.parse_data_attributes(e)})):this.parsed.push({options_index:this.options_index,empty:!0,data:this.parse_data_attributes(e)}),this.options_index+=1)}parse_data_attributes(e){const t={"data-option-array-index":this.parsed.length,"data-value":e.value};return this.copy_data_attributes&&e&&Array.from(e.attributes).forEach((e=>{const s=e.nodeName;/data-.*/.test(s)&&(t[s]=e.nodeValue)})),t}static select_to_array(t,s){const i=new e(s);return Array.from(t.childNodes).forEach((e=>i.add_node(e))),i.parsed}}class t{constructor(e,s={}){this.label_click_handler=this.label_click_handler.bind(this),this.form_field=e,this.options=s,t.browser_is_supported(s)&&(this.is_multiple=this.form_field.multiple,this.can_select_by_group=null!==this.form_field.getAttribute("select-by-group"),this.set_default_text(),this.set_default_values(),this.setup(),this.set_up_html(),this.register_observers(),this.on_ready())}set_default_values(){this.click_test_action=e=>this.test_active_click(e),this.activate_action=e=>this.activate_field(e),this.active_field=!1,this.mouse_on_container=!1,this.results_showing=!1,this.result_highlighted=null,this.is_rtl=this.options.rtl||/\bchosen-rtl\b/.test(this.form_field.className),this.allow_single_deselect=null!=this.options.allow_single_deselect&&null!=this.form_field.options[0]&&""===this.form_field.options[0].text&&this.options.allow_single_deselect,this.disable_search_threshold=this.options.disable_search_threshold||0,this.disable_search=this.options.disable_search||!1,this.enable_split_word_search=null==this.options.enable_split_word_search||this.options.enable_split_word_search,this.group_search=null==this.options.group_search||this.options.group_search,this.search_in_values=this.options.search_in_values||!1,this.search_contains=this.options.search_contains||!1,this.single_backstroke_delete=null==this.options.single_backstroke_delete||this.options.single_backstroke_delete,this.max_selected_options=this.options.max_selected_options||Number.POSITIVE_INFINITY,this.inherit_select_classes=this.options.inherit_select_classes||!1,this.inherit_option_classes=this.options.inherit_option_classes||!1,this.display_selected_options=null==this.options.display_selected_options||this.options.display_selected_options,this.display_disabled_options=null==this.options.display_disabled_options||this.options.display_disabled_options,this.parser_config=this.options.parser_config||{},this.include_group_label_in_selected=this.options.include_group_label_in_selected||!1,this.max_shown_results=this.options.max_shown_results||Number.POSITIVE_INFINITY,this.case_sensitive_search=this.options.case_sensitive_search||!1,this.hide_results_on_select=null==this.options.hide_results_on_select||this.options.hide_results_on_select,this.create_option=this.options.create_option||!1,this.persistent_create_option=this.options.persistent_create_option||!1,this.skip_no_results=this.options.skip_no_results||!1}set_default_text(){this.form_field.getAttribute("data-placeholder")?this.default_text=this.form_field.getAttribute("data-placeholder"):this.is_multiple?this.default_text=this.options.placeholder_text_multiple||this.options.placeholder_text||t.default_multiple_text:this.default_text=this.options.placeholder_text_single||this.options.placeholder_text||t.default_single_text,this.default_text=this.escape_html(this.default_text),this.results_none_found=this.form_field.getAttribute("data-no_results_text")||this.options.no_results_text||t.default_no_result_text,this.create_option_text=this.form_field.getAttribute("data-create_option_text")||this.options.create_option_text||t.default_create_option_text}choice_label(e){return this.include_group_label_in_selected&&null!=e.group_label?`<b class='group-name'>${this.escape_html(e.group_label)}</b>${e.html}`:e.html}mouse_enter(){this.mouse_on_container=!0}mouse_leave(){this.mouse_on_container=!1}input_focus(e){this.is_multiple?this.active_field||setTimeout((()=>{this.container_mousedown()}),50):this.active_field||this.activate_field()}input_blur(e){this.mouse_on_container||(this.active_field=!1,setTimeout((()=>{this.blur_test()}),100))}label_click_handler(e){this.is_multiple?this.container_mousedown(e):this.activate_field()}results_option_build(e){let t="",s=0;for(let i of this.results_data){let l="";if(l=i.group?this.result_add_group(i):this.result_add_option(i),""!==l&&(s++,t+=l),(null!=e?e.first:void 0)&&(i.selected&&this.is_multiple?this.choice_build(i):i.selected&&!this.is_multiple&&this.single_set_selected_text(this.choice_label(i))),s>=this.max_shown_results)break}return t}result_add_option(e){if(!e.search_match)return"";if(!this.include_option_in_results(e))return"";const t=[];e.disabled||e.selected&&this.is_multiple||t.push("active-result"),!e.disabled||e.selected&&this.is_multiple||t.push("disabled-result"),e.selected&&t.push("result-selected"),null!=e.group_array_index&&t.push("group-option"),""!==e.classes&&t.push(e.classes);const s=document.createElement("li");s.className=t.join(" "),e.style&&(s.style.cssText=e.style);for(let t in e.data)e.data.hasOwnProperty(t)&&s.setAttribute(t,e.data[t]);return s.setAttribute("role","option"),s.innerHTML=e.highlighted_html||e.html,s.id=`${this.form_field.id}-chosen-search-result-${e.data["data-option-array-index"]}`,e.title&&(s.title=e.title),s.outerHTML}result_add_group(e){if(!e.search_match&&!e.group_match)return"";if(!(e.active_options>0))return"";const t=[];t.push("group-result"),e.classes&&t.push(e.classes);const s=document.createElement("li");return s.className=t.join(" "),s.innerHTML=e.highlighted_html||this.escape_html(e.label),e.title&&(s.title=e.title),s.outerHTML}append_option(e){this.select_append_option(e)}results_update_field(){this.set_default_text(),this.is_multiple||this.results_reset_cleanup(),this.result_clear_highlight(),this.results_build(),this.results_showing&&this.winnow_results()}reset_single_select_options(){for(let e of this.results_data)e.selected&&(e.selected=!1)}results_toggle(){this.results_showing?this.results_hide():this.results_show()}results_search(e){this.results_showing?this.winnow_results():this.results_show();const t=new CustomEvent("chosen:search",{detail:{chosen:this}});this.form_field.dispatchEvent(t)}winnow_results(e){this.no_results_clear();let t=0,s=!1,i=!1;const l=this.get_search_text(),h=l.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&"),r=this.get_search_regex(h),a=new RegExp(`^${h}$`);this.get_highlight_regex(h);for(let e of this.results_data){e.search_match=!1;let h=null,o=null;if(e.highlighted_html="",this.include_option_in_results(e)){e.group&&(e.group_match=!1,e.active_options=0),null!=e.group_array_index&&this.results_data[e.group_array_index]&&(h=this.results_data[e.group_array_index],0===h.active_options&&h.search_match&&(t+=1),h.active_options+=1);let n=e.group?e.label:e.text;if(!e.group||this.group_search)if(o=this.search_string_match(n,r),e.search_match=null!=o,!e.search_match&&this.search_in_values&&(e.search_match=this.search_string_match(e.value,r),i=!0),e.search_match&&!e.group&&(t+=1),s=s||a.test(e.html),e.search_match){if(l.length&&!i){let t=o.index,s=n.slice(0,t),i=n.slice(t,t+l.length),h=n.slice(t+l.length);e.highlighted_html=`${this.escape_html(s)}<em>${this.escape_html(i)}</em>${this.escape_html(h)}`}null!=h&&(h.group_match=!0)}else null!=e.group_array_index&&this.results_data[e.group_array_index].search_match&&(e.search_match=!0)}}this.result_clear_highlight(),t<1&&l.length?(this.update_results_content(""),this.fire_search_updated(l),this.create_option&&this.skip_no_results||this.no_results(l)):(this.update_results_content(this.results_option_build()),this.fire_search_updated(l),(null!=e?e.skip_highlight:void 0)||this.winnow_results_set_highlight()),this.create_option&&(t<1||!s&&this.persistent_create_option)&&l.length&&this.show_create_option(l)}get_search_regex(e){let t=this.search_contains?e:`(^|\\s|\\b)${e}[^\\s]*`;this.enable_split_word_search||this.search_contains||(t=`^${t}`);const s=this.case_sensitive_search?"":"i";return new RegExp(t,s)}get_highlight_regex(e){const t=this.search_contains?"":"\\b",s=this.case_sensitive_search?"":"i";return new RegExp(t+e,s)}get_list_special_char(){const e=[];return e.push({val:"ae",let:"(ä|æ|ǽ)"}),e.push({val:"oe",let:"(ö|œ)"}),e.push({val:"ue",let:"(ü)"}),e.push({val:"Ae",let:"(Ä)"}),e.push({val:"Ue",let:"(Ü)"}),e.push({val:"Oe",let:"(Ö)"}),e.push({val:"AE",let:"(Æ|Ǽ)"}),e.push({val:"ss",let:"(ß)"}),e.push({val:"IJ",let:"(Ĳ)"}),e.push({val:"ij",let:"(ĳ)"}),e.push({val:"OE",let:"(Œ)"}),e.push({val:"A",let:"(À|Á|Â|Ã|Ä|Å|Ǻ|Ā|Ă|Ą|Ǎ)"}),e.push({val:"a",let:"(à|á|â|ã|å|ǻ|ā|ă|ą|ǎ|ª)"}),e.push({val:"C",let:"(Ç|Ć|Ĉ|Ċ|Č)"}),e.push({val:"c",let:"(ç|ć|ĉ|ċ|č)"}),e.push({val:"D",let:"(Ð|Ď|Đ)"}),e.push({val:"d",let:"(ð|ď|đ)"}),e.push({val:"E",let:"(È|É|Ê|Ë|Ē|Ĕ|Ė|Ę|Ě)"}),e.push({val:"e",let:"(è|é|ê|ë|ē|ĕ|ė|ę|ě)"}),e.push({val:"G",let:"(Ĝ|Ğ|Ġ|Ģ)"}),e.push({val:"g",let:"(ĝ|ğ|ġ|ģ)"}),e.push({val:"H",let:"(Ĥ|Ħ)"}),e.push({val:"h",let:"(ĥ|ħ)"}),e.push({val:"I",let:"(Ì|Í|Î|Ï|Ĩ|Ī|Ĭ|Ǐ|Į|İ)"}),e.push({val:"i",let:"(ì|í|î|ï|ĩ|ī|ĭ|ǐ|į|ı)"}),e.push({val:"J",let:"(Ĵ)"}),e.push({val:"j",let:"(ĵ)"}),e.push({val:"K",let:"(Ķ)"}),e.push({val:"k",let:"(ķ)"}),e.push({val:"L",let:"(Ĺ|Ļ|Ľ|Ŀ|Ł)"}),e.push({val:"l",let:"(ĺ|ļ|ľ|ŀ|ł)"}),e.push({val:"N",let:"(Ñ|Ń|Ņ|Ň)"}),e.push({val:"n",let:"(ñ|ń|ņ|ň|ŉ)"}),e.push({val:"O",let:"(Ò|Ó|Ô|Õ|Ō|Ŏ|Ǒ|Ő|Ơ|Ø|Ǿ)"}),e.push({val:"o",let:"(ò|ó|ô|õ|ō|ŏ|ǒ|ő|ơ|ø|ǿ|º)"}),e.push({val:"R",let:"(Ŕ|Ŗ|Ř)"}),e.push({val:"r",let:"(ŕ|ŗ|ř)"}),e.push({val:"S",let:"(Ś|Ŝ|Ş|Š)"}),e.push({val:"s",let:"(ś|ŝ|ş|š|ſ)"}),e.push({val:"T",let:"(Ţ|Ť|Ŧ)"}),e.push({val:"t",let:"(ţ|ť|ŧ)"}),e.push({val:"U",let:"(Ù|Ú|Û|Ũ|Ū|Ŭ|Ů|Ű|Ų|Ư|Ǔ|Ǖ|Ǘ|Ǚ|Ǜ)"}),e.push({val:"u",let:"(ù|ú|û|ũ|ū|ŭ|ů|ű|ų|ư|ǔ|ǖ|ǘ|ǚ|ǜ)"}),e.push({val:"Y",let:"(Ý|Ÿ|Ŷ)"}),e.push({val:"y",let:"(ý|ÿ|ŷ)"}),e.push({val:"W",let:"(Ŵ)"}),e.push({val:"w",let:"(ŵ)"}),e.push({val:"Z",let:"(Ź|Ż|Ž)"}),e.push({val:"z",let:"(ź|ż|ž)"}),e.push({val:"f",let:"(ƒ)"}),e}escape_special_char(e){const t=this.get_list_special_char();for(let s of t)e=e.replace(new RegExp(s.let,"g"),s.val);return e}search_string_match(e,t){let s=t.exec(e);return this.case_sensitive_search||null==s||(s=t.exec(this.escape_special_char(e))),!this.search_contains&&(null!=s?s[1]:void 0)&&(s.index+=1),s}choices_count(){if(null!=this.selected_option_count)return this.selected_option_count;this.selected_option_count=0;for(let e of this.form_field.options)e.selected&&(this.selected_option_count+=1);return this.selected_option_count}choices_click(e){e.preventDefault(),this.activate_field(),this.results_showing||this.is_disabled||this.results_show()}mousedown_checker(e){let t;switch((e=e||window.event).which||void 0===e.button||(e.which=1&e.button?1:2&e.button?3:4&e.button?2:0),e.which){case 1:t="left";break;case 2:t="middle";break;case 3:t="right";break;default:t="other"}return t}keydown_checker(e){const t=null!=e.which?e.which:e.keyCode;switch(this.search_field_scale(),8!==t&&this.pending_backstroke&&this.clear_backstroke(),t){case 8:this.backstroke_length=this.get_search_field_value().length;break;case 9:this.results_showing&&!this.is_multiple&&this.result_select(e),this.mouse_on_container=!1;break;case 13:case 27:this.results_showing&&e.preventDefault();break;case 32:this.disable_search&&e.preventDefault();break;case 38:e.preventDefault(),this.keyup_arrow();break;case 40:e.preventDefault(),this.keydown_arrow()}}keyup_checker(e){const t=null!=e.which?e.which:e.keyCode;switch(this.search_field_scale(),t){case 8:this.is_multiple&&this.backstroke_length<1&&this.choices_count()>0?this.keydown_backstroke():this.pending_backstroke||(this.result_clear_highlight(),this.results_search());break;case 13:e.preventDefault(),this.results_showing&&this.result_select(e);break;case 27:this.results_showing&&this.results_hide();break;case 9:case 16:case 17:case 18:case 38:case 40:case 91:break;default:this.results_search()}}clipboard_event_checker(e){this.is_disabled||setTimeout((()=>{this.results_search()}),50)}container_width(){return null!=this.options.width?this.options.width:this.form_field.offsetWidth>0?`${this.form_field.offsetWidth}px`:"auto"}include_option_in_results(e){return!(this.is_multiple&&!this.display_selected_options&&e.selected)&&(!(!this.display_disabled_options&&e.disabled)&&(!e.empty&&(!e.hidden&&(null==e.group_array_index||!this.results_data[e.group_array_index].hidden))))}search_results_touchstart(e){this.touch_started=!0,this.search_results_mouseover(e)}search_results_touchmove(e){this.touch_started=!1,this.search_results_mouseout(e)}search_results_touchend(e){this.touch_started&&this.search_results_mouseup(e)}get_single_html(){return`<a class="chosen-single chosen-default">\n  <span>${this.default_text}</span>\n  <div aria-label="Show options"><b aria-hidden="true"></b></div>\n</a>\n<div class="chosen-drop">\n  <div class="chosen-search">\n    <input class="chosen-search-input" type="text" autocomplete="off" role="combobox" aria-expanded="false" aria-haspopup="true" aria-autocomplete="list" autocomplete="off" />\n  </div>\n  <ul class="chosen-results" role="listbox"></ul>\n</div>`}get_multi_html(){return`<ul class="chosen-choices">\n  <li class="search-field">\n    <input class="chosen-search-input" type="text" autocomplete="off" role="combobox" placeholder="${this.default_text}" aria-expanded="false" aria-haspopup="true" aria-autocomplete="list" />\n  </li>\n</ul>\n<div class="chosen-drop">\n  <ul class="chosen-results" role="listbox"></ul>\n</div>`}get_no_results_html(e){return`<li class="no-results">\n  ${this.results_none_found} <span>${this.escape_html(e)}</span>\n</li>`}get_option_html({value:e,text:t}){return`<option value="${e}" selected>${t}</option>`}get_create_option_html(e){return`<li class="create-option active-result" role="option"><a>${this.create_option_text}</a> <span>${this.escape_html(e)}</span></li>`}static browser_is_supported(e){const t=window.navigator.userAgent,s=/iP(od|hone)/i.test(t),i=/Android.*Mobile/i.test(t),l=/IEMobile/i.test(t)||/Windows Phone/i.test(t)||/BlackBerry/i.test(t)||/BB10/i.test(t);if(e&&e.allow_mobile){if(s||i)return!0;if(l)return!1}return!(s||i||l)}escape_html(e){const t=document.createElement("div");return t.textContent=e,t.innerHTML}}t.default_multiple_text="Select Some Options",t.default_single_text="Select an Option",t.default_no_result_text="No results for:",t.default_create_option_text="Add Option:",t.default_remove_item_text="Remove selection";class s extends t{setup(){this.current_selectedIndex=this.form_field.selectedIndex}set_up_html(){let e=["chosen-container"];e.push("chosen-container-"+(this.is_multiple?"multi":"single")),this.inherit_select_classes&&this.form_field.className&&e.push(this.form_field.className),this.is_rtl&&e.push("chosen-rtl");const t={class:e.join(" "),title:this.form_field.title};this.form_field.id.length&&(t.id=this.form_field.id.replace(/[^\w]/g,"_")+"_chosen"),this.container=document.createElement("div");for(let e in t)this.container.setAttribute(e,t[e]);this.container.style.width=this.container_width(),this.is_multiple?this.container.innerHTML=this.get_multi_html():this.container.innerHTML=this.get_single_html(),this.form_field.style.position="absolute",this.form_field.style.opacity=0,this.form_field.style.display="none",this.form_field.parentNode.insertBefore(this.container,this.form_field.nextSibling),this.dropdown=this.container.querySelector("div.chosen-drop"),this.search_field=this.container.querySelector("input"),this.search_results=this.container.querySelector("ul.chosen-results"),this.search_results.setAttribute("id",`${this.form_field.id}-chosen-search-results`),this.search_field_scale(),this.is_multiple?(this.search_choices=this.container.querySelector("ul.chosen-choices"),this.search_container=this.container.querySelector("li.search-field")):(this.search_container=this.container.querySelector("div.chosen-search"),this.selected_item=this.container.querySelector(".chosen-single")),this.set_aria_labels(),this.results_build(),this.set_tab_index(),this.set_label_behavior()}on_ready(){const e=new CustomEvent("chosen:ready",{detail:{chosen:this}});this.form_field.dispatchEvent(e)}register_observers(){this.container.addEventListener("touchstart",(e=>this.container_mousedown(e))),this.container.addEventListener("touchend",(e=>this.container_mouseup(e))),this.container.addEventListener("mousedown",(e=>this.container_mousedown(e))),this.container.addEventListener("mouseup",(e=>this.container_mouseup(e))),this.container.addEventListener("mouseenter",(e=>this.mouse_enter(e))),this.container.addEventListener("mouseleave",(e=>this.mouse_leave(e))),this.search_results.addEventListener("mouseup",(e=>this.search_results_mouseup(e))),this.search_results.addEventListener("mouseover",(e=>this.search_results_mouseover(e))),this.search_results.addEventListener("mouseout",(e=>this.search_results_mouseout(e))),this.search_results.addEventListener("mousewheel",(e=>this.search_results_mousewheel(e))),this.search_results.addEventListener("DOMMouseScroll",(e=>this.search_results_mousewheel(e))),this.search_results.addEventListener("touchstart",(e=>this.search_results_touchstart(e))),this.search_results.addEventListener("touchmove",(e=>this.search_results_touchmove(e))),this.search_results.addEventListener("touchend",(e=>this.search_results_touchend(e))),this.form_field.addEventListener("chosen:updated",(e=>this.results_update_field(e))),this.form_field.addEventListener("chosen:activate",(e=>this.activate_field(e))),this.form_field.addEventListener("chosen:open",(e=>this.container_mousedown(e))),this.form_field.addEventListener("chosen:close",(e=>this.close_field(e))),this.search_field.addEventListener("blur",(e=>this.input_blur(e))),this.search_field.addEventListener("keyup",(e=>this.keyup_checker(e))),this.search_field.addEventListener("keydown",(e=>this.keydown_checker(e))),this.search_field.addEventListener("focus",(e=>this.input_focus(e))),this.search_field.addEventListener("cut",(e=>this.clipboard_event_checker(e))),this.search_field.addEventListener("paste",(e=>this.clipboard_event_checker(e))),this.is_multiple?this.search_choices.addEventListener("click",(e=>this.choices_click(e))):this.container.addEventListener("click",(e=>e.preventDefault()))}destroy(){(null!=this.container.getRootNode?this.container.getRootNode():this.container.ownerDocument).removeEventListener("click",this.click_test_action),this.form_field_label&&this.form_field_label.removeEventListener("click",this.label_click_handler),this.search_field.tabIndex&&(this.form_field.tabIndex=this.search_field.tabIndex),this.container.parentNode.removeChild(this.container),delete this.form_field.__chosen_instance,this.form_field.style.display=""}set_aria_labels(){if(this.search_field.setAttribute("aria-owns",this.search_results.getAttribute("id")),this.form_field.getAttribute("aria-label"))this.search_field.setAttribute("aria-label",this.form_field.getAttribute("aria-label")),this.form_field.getAttribute("aria-labelledby")&&this.search_field.setAttribute("aria-labelledby",this.form_field.getAttribute("aria-labelledby"));else if(this.form_field.labels&&this.form_field.labels.length){let e="";for(let t=0;t<this.form_field.labels.length;t++){let s=this.form_field.labels[t];""===s.id&&(s.id=`${this.form_field.id}-chosen-label-${t}`),e+=this.form_field.labels[t].id+" "}this.search_field.setAttribute("aria-labelledby",e)}}search_field_disabled(){this.is_disabled=this.form_field.disabled||this.form_field.closest("fieldset:disabled"),this.is_disabled?(this.container.classList.add("chosen-disabled"),this.search_field.disabled=!0,this.is_multiple||this.selected_item.removeEventListener("focus",this.activate_field),this.close_field()):(this.container.classList.remove("chosen-disabled"),this.search_field.disabled=!1,this.is_multiple||this.selected_item.addEventListener("focus",this.activate_field.bind(this)))}container_mousedown(e){if(!this.is_disabled&&(e&&"left"===this.mousedown_checker(e)&&e&&"mousedown"===e.type&&!this.results_showing&&e.preventDefault(),!e||"mousedown"!==e.type&&"touchstart"!==e.type||this.results_showing||e.preventDefault(),null==e||!e.target.classList.contains("search-choice-close"))){if(this.active_field)this.is_multiple||!e||e.target!==this.selected_item&&!e.target.closest("a.chosen-single")||(e.preventDefault(),this.results_toggle());else{this.is_multiple&&(this.search_field.value="");(null!=this.container.getRootNode?this.container.getRootNode():this.container.ownerDocument).addEventListener("click",this.click_test_action),this.results_show()}this.activate_field()}}container_mouseup(e){!this.is_disabled&&this.allow_single_deselect&&e.target.classList.contains("search-choice-close")&&this.results_reset(e)}search_results_mousewheel(e){let t;t=e.wheelDelta?-e.wheelDelta:e.deltaY||e.detail,null!=t&&(e.preventDefault(),"DOMMouseScroll"===e.type&&(t*=40),this.search_results.scrollTop+=t)}blur_test(e){!this.active_field&&this.container.classList.contains("chosen-container-active")&&this.close_field()}close_field(){(null!=this.container.getRootNode?this.container.getRootNode():this.container.ownerDocument).removeEventListener("click",this.click_test_action),this.active_field=!1,this.results_hide(),this.search_field.setAttribute("aria-expanded",!1),this.container.classList.remove("chosen-container-active"),this.container.classList.remove("chosen-dropup"),this.clear_backstroke(),this.show_search_field_default(),this.search_field_scale(),this.search_field.dispatchEvent(new Event("blur"))}should_dropup(){const e=window.innerHeight,t=this.container.getBoundingClientRect().top+this.container.offsetHeight-window.pageYOffset;return this.dropdown.offsetHeight+t>e}activate_field(){this.is_disabled||(this.container.classList.add("chosen-container-active"),this.should_dropup()&&this.container.classList.add("chosen-dropup"),this.active_field=!0,this.search_field.value=this.search_field.value,this.search_results.setAttribute("aria-busy",!1),this.search_field.focus())}test_active_click(e){const t=e.target.closest(".chosen-container");"left"===this.mousedown_checker(e)&&t&&this.container===t?this.active_field=!0:this.close_field()}results_build(){if(this.parsing=!0,this.selected_option_count=null,this.results_data=e.select_to_array(this.form_field,this.parser_config),this.is_multiple){this.search_choices.querySelectorAll("li.search-choice").forEach((e=>e.remove()))}else this.single_set_selected_text(),this.disable_search||this.form_field.options.length<=this.disable_search_threshold&&!this.create_option?(this.search_field.readOnly=!0,this.container.classList.add("chosen-container-single-nosearch")):(this.search_field.readOnly=!1,this.container.classList.remove("chosen-container-single-nosearch"));this.update_results_content(this.results_option_build({first:!0})),this.search_field_disabled(),this.show_search_field_default(),this.search_field_scale(),this.parsing=!1}update_results_content(e){this.search_results.innerHTML=e}fire_search_updated(e){const t=new CustomEvent("chosen:search_updated",{detail:{chosen:this,search_term:e}});this.form_field.dispatchEvent(t)}result_do_highlight(e){if(e){this.result_clear_highlight(),this.result_highlight=e,this.result_highlight.classList.add("highlighted"),this.search_field.setAttribute("aria-activedescendant",this.result_highlight.getAttribute("id"));const t=parseInt(window.getComputedStyle(this.search_results).maxHeight,10),s=this.search_results.scrollTop,i=t+s,l=this.result_highlight.offsetTop,h=l+this.result_highlight.offsetHeight;h>=i?this.search_results.scrollTop=h-t:l<s&&(this.search_results.scrollTop=l)}}result_clear_highlight(){this.result_highlight&&this.result_highlight.classList.remove("highlighted"),this.result_highlight=null}results_show(){if(this.is_multiple&&this.max_selected_options<=this.choices_count()){const e=new CustomEvent("chosen:maxselected",{detail:{chosen:this}});return this.form_field.dispatchEvent(e),!1}this.should_dropup()&&this.container.classList.add("chosen-dropup"),this.container.classList.add("chosen-with-drop");const e=this.container.querySelector(".chosen-single div");e&&e.setAttribute("aria-label","Hide options"),this.results_showing=!0,this.search_field.setAttribute("aria-expanded",!0),this.search_field.focus(),this.search_field.value=this.get_search_field_value(),this.winnow_results();const t=new CustomEvent("chosen:showing_dropdown",{detail:{chosen:this}});this.form_field.dispatchEvent(t)}results_hide(){if(this.results_showing){this.result_clear_highlight(),this.container.classList.remove("chosen-with-drop"),this.container.classList.remove("chosen-dropup");const e=this.container.querySelector(".chosen-single div");e&&e.setAttribute("aria-label","Show options");const t=new CustomEvent("chosen:hiding_dropdown",{detail:{chosen:this}});this.form_field.dispatchEvent(t)}this.search_field.setAttribute("aria-expanded",!1),this.results_showing=!1}set_tab_index(){if(this.form_field.tabIndex){const e=this.form_field.tabIndex;this.form_field.tabIndex=-1,this.search_field.tabIndex=e}}set_label_behavior(){this.form_field_label=this.form_field.closest("label"),!this.form_field_label&&this.form_field.id.length&&(this.form_field_label=document.querySelector(`label[for='${this.form_field.id}']`)),this.form_field_label&&this.form_field_label.addEventListener("click",this.label_click_handler)}set_search_field_placeholder(){this.is_multiple&&this.choices_count()<1?this.search_field.setAttribute("placeholder",this.default_text):this.search_field.setAttribute("placeholder","")}show_search_field_default(){this.search_field.value="",this.set_search_field_placeholder(),this.is_multiple&&this.choices_count()<1&&!this.active_field?this.search_field.classList.add("default"):this.search_field.classList.remove("default")}search_results_mouseup(e){if("left"===this.mousedown_checker(e)){let t=e.target.classList.contains("active-result")||e.target.classList.contains("group-result")?e.target:e.target.closest(".active-result");t&&(this.result_highlight=t,this.result_select(e),this.search_field.focus())}}search_results_mouseover(e){let t=e.target.classList.contains("active-result")?e.target:e.target.closest(".active-result");t&&this.result_do_highlight(t)}search_results_mouseout(e){(e.target.classList.contains("active-result")||e.target.closest(".active-result"))&&this.result_clear_highlight()}choice_build(e){const s=document.createElement("li");if(s.className="search-choice",s.setAttribute("data-value",e.value),s.setAttribute("role","option"),s.innerHTML=`<span>${this.choice_label(e)}</span>`,e.disabled)s.classList.add("search-choice-disabled");else{const i=document.createElement("button");i.type="button",i.tabIndex=-1,i.className="search-choice-close",i.setAttribute("data-option-array-index",e.data["data-option-array-index"]);const l=document.createElement("span");l.className="visually-hidden focusable",l.textContent=t.default_remove_item_text,i.appendChild(l),i.addEventListener("click",(e=>this.choice_destroy_link_click(e))),s.appendChild(i)}this.inherit_option_classes&&e.classes&&s.classList.add(e.classes),this.search_container.parentNode.insertBefore(s,this.search_container)}choice_destroy_link_click(e){e.preventDefault(),e.stopPropagation(),this.is_disabled||this.choice_destroy(e.target)}choice_destroy(e){this.result_deselect(e.getAttribute("data-option-array-index"))&&(this.active_field?this.search_field.focus():this.show_search_field_default(),this.is_multiple&&this.hide_results_on_select&&this.choices_count()>0&&this.get_search_field_value().length<1&&this.results_hide(),e.closest("li").remove(),this.set_search_field_placeholder(),this.search_field_scale())}results_reset(){this.reset_single_select_options(),this.form_field.options[0].selected=!0,this.single_set_selected_text(),this.show_search_field_default(),this.results_reset_cleanup(),this.trigger_form_field_change(),this.active_field&&this.results_hide()}results_reset_cleanup(){this.current_selectedIndex=this.form_field.selectedIndex;const e=this.selected_item.querySelector(".search-choice-close");e&&e.remove()}result_select(e){if(e.target.classList.contains("group-result")){if(!this.can_select_by_group)return;let t=e.target.nextElementSibling;for(;t&&!t.classList.contains("group-result");){if(t.classList.contains("active-result")){const s=t.getAttribute("data-option-array-index");let i=!1;this.search_choices.querySelectorAll(".search-choice-close").forEach((e=>{e.getAttribute("data-option-array-index")===s&&(i=!0)})),i||(this.result_highlight=t,e.target=t,e.selected=!0,this.result_select(e))}t=t.nextElementSibling}}else if(this.result_highlight){const t=this.result_highlight;if(t.classList.contains("create-option"))return this.select_create_option(this.search_field.value),void this.results_hide();if(this.result_clear_highlight(),this.is_multiple&&this.max_selected_options<=this.choices_count()){const e=new CustomEvent("chosen:maxselected",{detail:{chosen:this}});return this.form_field.dispatchEvent(e),!1}this.is_multiple?t.classList.remove("active-result"):this.reset_single_select_options(),t.classList.add("result-selected");const s=this.results_data[t.getAttribute("data-option-array-index")];s.selected=!0,this.form_field.options[s.options_index].selected=!0,this.selected_option_count=null,this.is_multiple?this.choice_build(s):this.single_set_selected_text(this.choice_label(s)),this.is_multiple&&(!this.hide_results_on_select||e.metaKey||e.ctrlKey)?e.metaKey||e.ctrlKey?this.winnow_results({skip_highlight:!0}):(this.search_field.value="",this.winnow_results()):(this.results_hide(),this.show_search_field_default()),(this.is_multiple||this.form_field.selectedIndex!==this.current_selectedIndex)&&this.trigger_form_field_change({selected:this.form_field.options[s.options_index].value}),this.current_selectedIndex=this.form_field.selectedIndex,e.preventDefault(),this.search_field_scale()}}single_set_selected_text(e=this.default_text){e===this.default_text?this.selected_item.classList.add("chosen-default"):(this.single_deselect_control_build(),this.selected_item.classList.remove("chosen-default")),this.selected_item.querySelector("span").innerHTML=e}result_deselect(e){const t=this.results_data[e];return!this.form_field.options[t.options_index].disabled&&(t.selected=!1,this.form_field.options[t.options_index].selected=!1,this.selected_option_count=null,this.result_clear_highlight(),this.results_showing&&this.winnow_results(),this.trigger_form_field_change({deselected:this.form_field.options[t.options_index].value}),this.search_field_scale(),!0)}single_deselect_control_build(){if(this.allow_single_deselect){if(!this.selected_item.querySelector(".search-choice-close")){const e=document.createElement("button");e.type="button",e.tabIndex=-1,e.className="search-choice-close",this.selected_item.querySelector("span").after(e)}this.selected_item.classList.add("chosen-single-with-deselect")}}get_search_field_value(){return this.search_field.value}get_search_text(){return this.get_search_field_value().trim()}winnow_results_set_highlight(){let e;const t=this.is_multiple?null:this.search_results.querySelector(".result-selected.active-result");e=t||this.search_results.querySelector(".active-result"),null!=e&&this.result_do_highlight(e)}no_results(e){const t=this.get_no_results_html(e);this.search_results.insertAdjacentHTML("beforeend",t);const s=new CustomEvent("chosen:no_results",{detail:{chosen:this}});this.form_field.dispatchEvent(s)}show_create_option(e){const t=this.get_create_option_html(e);this.search_results.insertAdjacentHTML("beforeend",t)}create_option_clear(){const e=this.search_results.querySelector(".create-option");e&&e.remove()}select_create_option(e){"function"==typeof this.create_option?this.create_option.call(this,e):this.select_append_option({value:e,text:e})}select_append_option(e){const t=this.get_option_html(e);this.form_field.insertAdjacentHTML("beforeend",t);const s=new Event("chosen:updated");this.form_field.dispatchEvent(s);const i=new Event("change");this.form_field.dispatchEvent(i),this.search_field.focus()}no_results_clear(){const e=this.search_results.querySelector(".no-results");e&&e.remove()}keydown_arrow(){let e;if(this.results_showing&&this.result_highlight){for(e=this.result_highlight.nextElementSibling;e&&!e.classList.contains("active-result");)e=e.nextElementSibling;e&&this.result_do_highlight(e)}else if(this.results_showing&&this.create_option){const e=this.search_results.querySelector(".create-option");e&&this.result_do_highlight(e)}else this.results_show()}keyup_arrow(){let e;if(this.results_showing||this.is_multiple){if(this.result_highlight){for(e=this.result_highlight.previousElementSibling;e&&!e.classList.contains("active-result");)e=e.previousElementSibling;e?this.result_do_highlight(e):(this.choices_count()>0&&this.results_hide(),this.result_clear_highlight())}}else this.results_show()}keydown_backstroke(){if(this.pending_backstroke)this.choice_destroy(this.pending_backstroke.querySelector(".search-choice-close")),this.clear_backstroke();else{const e=this.search_container.previousElementSibling;e&&!e.classList.contains("search-choice-disabled")&&(this.pending_backstroke=e,this.single_backstroke_delete?this.keydown_backstroke():this.pending_backstroke.classList.add("search-choice-focus"))}}clear_backstroke(){this.pending_backstroke&&this.pending_backstroke.classList.remove("search-choice-focus"),this.pending_backstroke=null}search_field_scale(){if(!this.is_multiple)return;const e={position:"absolute",left:"-1000px",top:"-1000px",whiteSpace:"pre"};["fontSize","fontStyle","fontWeight","fontFamily","lineHeight","textTransform","letterSpacing"].forEach((t=>{e[t]=window.getComputedStyle(this.search_field)[t]}));const t=document.createElement("div");Object.assign(t.style,e),t.textContent=this.get_search_field_value()||this.search_field.getAttribute("placeholder"),document.body.appendChild(t);let s=t.offsetWidth+25;t.remove(),this.container.offsetWidth>0&&(s=Math.min(this.container.offsetWidth-10,s)),this.search_field.style.width=`${s}px`}trigger_form_field_change(e){const t=new Event("input"),s=new Event("change",e);this.form_field.dispatchEvent(t),this.form_field.dispatchEvent(s)}}HTMLElement.prototype.chosen=function(e){if(!t.browser_is_supported(e))return this;"destroy"!==e?this.__chosen_instance instanceof s||(this.__chosen_instance=new s(this,e)):this.__chosen_instance instanceof s&&this.__chosen_instance.destroy()}}).call(this);